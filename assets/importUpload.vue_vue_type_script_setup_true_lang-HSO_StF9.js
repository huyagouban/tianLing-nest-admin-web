import{g as V,r as m,X as T,o as f,h as w,x as i,y as a,s as c,t as d,k as _,v as O,a7 as z,J as D,af as n,bk as I,ae as J,E as R,N as L}from"./index-gd7kCRgy.js";import{E as M}from"./el-dialog-HOZYi4L2.js";import{g as P,E as X}from"./el-progress-DROy-hyt.js";import{E as $}from"./el-link-gqXlvqu7.js";import{d as j}from"./index-DgcNhbwt.js";import{g as q}from"./upload-DMW0ZTpt.js";const A=c("div",{class:"el-upload__text"},[d(" 将文件拖到此处，或 "),c("em",null,"点击上传")],-1),G={class:"el-upload__tip text-center"},H={class:"dialog-footer"},le=V({__name:"importUpload",props:{dialogVisible:{type:Boolean,default:!1},title:{default:"导入"},draggable:{type:Boolean,default:!1},width:{default:"680px"},isTemlate:{type:Boolean,default:!0},uploadFile:{default:()=>({temlateUrl:"",uploadUrl:"",multiple:!1,accept:".xls,.xlsx",autoUpload:!0})}},emits:["importClose"],setup(g,{emit:x}){const l=g,t=m(!1),o=m(),r=x,u=()=>{t.value||(o.value.clearFiles(),r("importClose"))},v=()=>{if(!l.uploadFile.temlateUrl)return n("请设置模板下载路径");q(`${l.uploadFile.temlateUrl}`).then(e=>{j(e.data.data,"导入模板")})},b=()=>{o.value.submit()},E=e=>{if(e.status==404)n(I[404]);else{let s=JSON.parse(e.message);n(s.message)}t.value=!1},h=e=>{e.status==200?(J(e.message),r("importClose")):(o.value.clearFiles(),t.value=!1,n(e.message))},k=e=>{o.value.clearFiles();const s=e[0];s.uid=P(),o.value.handleStart(s)},y=e=>{if(!(e.name.indexOf(".xls")>-1||e.name.indexOf(".xlsx")>-1))return n("上传文件只能是 xls、xlsx 格式!"),!1;if(e.size>10*1024*1024)return n("上传文件大小不能超过 10MB!"),!1},C=()=>{t.value=!0};return(e,s)=>{const F=T("upload-filled"),U=R,B=$,N=X,p=L,S=M;return f(),w("div",null,[i(S,{draggable:l.draggable,"model-value":l.dialogVisible,title:l.title,width:l.width,"before-close":u},{footer:a(()=>[c("div",H,[i(p,{onClick:u},{default:a(()=>[d("取消")]),_:1}),i(p,{type:"primary",loading:_(t),onClick:b},{default:a(()=>[d(" 确定 ")]),_:1},8,["loading"])])]),default:a(()=>[i(N,{ref_key:"uploadRef",ref:o,drag:"",action:l.uploadFile.uploadUrl,limit:1,disabled:_(t),"on-progress":C,"auto-upload":l.uploadFile.autoUpload,multiple:l.uploadFile.multiple,"before-upload":y,accept:l.uploadFile.accept,"on-error":E,"on-success":h,"on-exceed":k},{tip:a(()=>[c("div",G,[d(" 仅支持"+O(l.uploadFile.accept?l.uploadFile.accept:".xls,.xlsx")+"格式文件。",1),l.isTemlate?(f(),z(B,{key:0,type:"primary",style:{"font-size":"12px","vertical-align":"baseline"},onClick:v},{default:a(()=>[d("下载模板")]),_:1})):D("",!0)])]),default:a(()=>[i(U,{class:"el-icon--upload"},{default:a(()=>[i(F)]),_:1}),A]),_:1},8,["action","disabled","auto-upload","multiple","accept"])]),_:1},8,["draggable","model-value","title","width"])])}}});export{le as _};
