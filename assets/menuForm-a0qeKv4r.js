import{u as ce,w as J,ar as B,as as P,at as le,U as w,f as M,g as j,au as ie,av as re,l as me,r as O,aw as H,R as te,ax as D,_ as fe,X as pe,o as N,h as _e,x as t,y as l,s as ve,t as y,k as u,a7 as x,a8 as he,S as ye,J as F,ad as ke,ae as Z,E as Ve,a1 as be,ay as Ce,N as ge,Q as Ne}from"./index-CpodFpUQ.js";import{E as Ee}from"./el-dialog-BdRR_6YM.js";import{a as xe,E as Te}from"./el-form-item-CvcOi-Xh.js";import{E as Ke}from"./el-row-D5xM9lwf.js";import{_ as $,a as Se,u as Fe,s as Oe,b as Ae}from"./menu-BR7_zR8D.js";import{E as Me}from"./el-input-number--l3XrVoV.js";import{s as Ie,e as Ue,E as we}from"./svgSelect-CiMQhQkO.js";import{E as Le,a as Re}from"./el-tab-pane-DYaV8fPe.js";import{E as Be,a as Pe}from"./el-radio-BM65Nv2y.js";import{E as je}from"./el-col-57__bE4T.js";import{a as Q,E as ee}from"./el-select-B4_7IAkN.js";import"./el-checkbox-gOJjs20a.js";import{e as qe}from"./strings-tw-UTuVM.js";import{i as He}from"./isEqual-DA5FAILj.js";import{s as De}from"./token-DI9FKtlJ.js";import"./_baseClone-Bd2QEoHD.js";import"./index-D5u5-p8S.js";import"./debounce-DB3PlMcl.js";const $e=(e,{attrs:r,emit:_},{select:v,tree:c,key:d})=>{const a=ce("tree-select");return J(()=>e.data,()=>{e.filterable&&B(()=>{var o,b;(b=c.value)==null||b.filter((o=v.value)==null?void 0:o.states.inputValue)})},{flush:"post"}),{...P(le(e),Object.keys(Q.props)),...r,"onUpdate:modelValue":o=>_(w,o),valueKey:d,popperClass:M(()=>{const o=[a.e("popper")];return e.popperClass&&o.push(e.popperClass),o.join(" ")}),filterMethod:(o="")=>{var b;e.filterMethod?e.filterMethod(o):e.remoteMethod?e.remoteMethod(o):(b=c.value)==null||b.filter(o)}}},Qe=j({extends:ee,setup(e,r){const _=ee.setup(e,r);delete _.selectOptionClick;const v=ie().proxy;return B(()=>{_.select.states.cachedOptions.get(v.value)||_.select.onOptionCreate(v)}),_},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function z(e){return e||e===0}function X(e){return Array.isArray(e)&&e.length}function U(e){return Array.isArray(e)?e:z(e)?[e]:[]}function L(e,r,_,v,c){for(let d=0;d<e.length;d++){const a=e[d];if(r(a,d,e,c))return v?v(a,d,e,c):a;{const E=_(a);if(X(E)){const o=L(E,r,_,v,a);if(o)return o}}}}function G(e,r,_,v){for(let c=0;c<e.length;c++){const d=e[c];r(d,c,e,v);const a=_(d);X(a)&&G(a,r,_,d)}}const ze=(e,{attrs:r,slots:_,emit:v},{select:c,tree:d,key:a})=>{J(()=>e.modelValue,()=>{e.showCheckbox&&B(()=>{const s=d.value;s&&!He(s.getCheckedKeys(),U(e.modelValue))&&s.setCheckedKeys(U(e.modelValue))})},{immediate:!0,deep:!0});const E=M(()=>({value:a.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),o=(s,i)=>{var p;const h=E.value[s];return re(h)?h(i,(p=d.value)==null?void 0:p.getNode(o("value",i))):i[h]},b=U(e.modelValue).map(s=>L(e.data||[],i=>o("value",i)===s,i=>o("children",i),(i,p,h,n)=>n&&o("value",n))).filter(s=>z(s)),A=M(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const s=[];return G(e.data.concat(e.cacheData),i=>{const p=o("value",i);s.push({value:p,currentLabel:o("label",i),isDisabled:o("disabled",i)})},i=>o("children",i)),s});return{...P(le(e),Object.keys($.props)),...r,nodeKey:a,expandOnClickNode:M(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:M(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(b):b),renderContent:(s,{node:i,data:p,store:h})=>s(Qe,{value:o("value",p),label:o("label",p),disabled:o("disabled",p)},e.renderContent?()=>e.renderContent(s,{node:i,data:p,store:h}):_.default?()=>_.default({node:i,data:p,store:h}):void 0),filterNodeMethod:(s,i,p)=>e.filterNodeMethod?e.filterNodeMethod(s,i,p):s?new RegExp(qe(s),"i").test(o("label",i)||""):!0,onNodeClick:(s,i,p)=>{var h,n,T,k;if((h=r.onNodeClick)==null||h.call(r,s,i,p),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||i.isLeaf)){if(!o("disabled",s)){const V=(n=c.value)==null?void 0:n.states.options.get(o("value",s));(T=c.value)==null||T.handleOptionSelect(V)}}else e.expandOnClickNode&&p.proxy.handleExpandIconClick();(k=c.value)==null||k.focus()}},onCheck:(s,i)=>{var p;if(!e.showCheckbox)return;const h=o("value",s),n={};G([d.value.store.root],m=>n[m.key]=m,m=>m.childNodes);const T=i.checkedKeys,k=e.multiple?U(e.modelValue).filter(m=>!(m in n)&&!T.includes(m)):[],V=k.concat(T);if(e.checkStrictly)v(w,e.multiple?V:V.includes(h)?h:void 0);else if(e.multiple)v(w,k.concat(d.value.getCheckedKeys(!0)));else{const m=L([s],g=>!X(o("children",g))&&!o("disabled",g),g=>o("children",g)),C=m?o("value",m):void 0,q=z(e.modelValue)&&!!L([s],g=>o("value",g)===e.modelValue,g=>o("children",g));v(w,C===e.modelValue||q?void 0:C)}B(()=>{var m;const C=U(e.modelValue);d.value.setCheckedKeys(C),(m=r.onCheck)==null||m.call(r,s,{checkedKeys:d.value.getCheckedKeys(),checkedNodes:d.value.getCheckedNodes(),halfCheckedKeys:d.value.getHalfCheckedKeys(),halfCheckedNodes:d.value.getHalfCheckedNodes()})}),(p=c.value)==null||p.focus()},cacheOptions:A}};var Ge=j({props:{data:{type:Array,default:()=>[]}},setup(e){const r=me(De);return J(()=>e.data,()=>{var _;e.data.forEach(c=>{r.states.cachedOptions.has(c.value)||r.states.cachedOptions.set(c.value,c)});const v=((_=r.selectRef)==null?void 0:_.querySelectorAll("input"))||[];Array.from(v).includes(document.activeElement)||r.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Je=j({name:"ElTreeSelect",inheritAttrs:!1,props:{...Q.props,...$.props,cacheData:{type:Array,default:()=>[]}},setup(e,r){const{slots:_,expose:v}=r,c=O(),d=O(),a=M(()=>e.nodeKey||e.valueKey||"value"),E=$e(e,r,{select:c,tree:d,key:a}),{cacheOptions:o,...b}=ze(e,r,{select:c,tree:d,key:a}),A=H({});return v(A),te(()=>{Object.assign(A,{...P(d.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...P(c.value,["focus","blur"])})}),()=>D(Q,H({...E,ref:s=>c.value=s}),{..._,default:()=>[D(Ge,{data:o.value}),D($,H({...b,ref:s=>d.value=s}))]})}});var R=fe(Je,[["__file","tree-select.vue"]]);R.install=e=>{e.component(R.name,R)};const Xe=R,We=Xe,Ye={class:"dialog-footer"},Ze=j({__name:"menuForm",props:{dialogVisible:{type:Boolean,default:!1},title:{default:""},id:{default:null},menuForm:{default:()=>({})}},emits:["emitAddFormBtn"],setup(e,{emit:r}){const _=r,v=O(),c=O([]),d=e,a=O({parentId:0,menuType:"M",icon:"",iconType:"",menuName:"",sortNum:void 0,isLink:"0",path:"",component:"",perms:"",isCache:"0",visible:"1",status:"1"}),E=O({menuName:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],sortNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"}]}),o=O("Svg"),b=()=>{Se().then(h=>{const n={id:0,parentId:0,menuName:"主类目",children:[]};n.children=h.data,c.value.push(n)})},A={children:"children",label:"menuName"},s=(h,n)=>{a.value.icon=h,a.value.iconType=n},i=()=>{v.value.validate(h=>{h&&ke("是否确认提交？").then(()=>{a.value.id?Fe(a.value).then(n=>{Z("修改成功"),p()}):Oe(a.value).then(n=>{Z("新增成功"),p()})})})},p=()=>{v.value.resetFields(),_("emitAddFormBtn",!1)};return te(()=>{d.menuForm.id&&(a.value=d.menuForm),d.id&&(a.value.parentId=d.id),b()}),(h,n)=>{const T=We,k=xe,V=je,m=Be,C=Pe,q=pe("tl-icon"),g=Ve,I=be,W=Le,ae=Re,oe=we,ne=Me,K=Ae,S=Ce,ue=Ke,se=Te,Y=ge,de=Ee;return N(),_e("div",null,[t(de,{"model-value":d.dialogVisible,title:d.title,width:"680px","before-close":p,"destroy-on-close":""},{footer:l(()=>[ve("div",Ye,[t(Y,{type:"primary",onClick:i},{default:l(()=>[y(" 确定 ")]),_:1}),t(Y,{onClick:p},{default:l(()=>[y("取消")]),_:1})])]),default:l(()=>[t(se,{model:u(a),ref_key:"formRef",ref:v,"label-width":"100px",rules:u(E)},{default:l(()=>[t(ue,null,{default:l(()=>[t(V,{span:24},{default:l(()=>[t(k,{label:"上级菜单",prop:"parentId"},{default:l(()=>[t(T,{modelValue:u(a).parentId,"onUpdate:modelValue":n[0]||(n[0]=f=>u(a).parentId=f),"node-key":"id","check-strictly":"",placeholder:"请选择上级菜单",props:A,data:u(c),"render-after-expand":!1,style:{width:"508px"}},null,8,["modelValue","data"])]),_:1})]),_:1}),t(V,{span:24},{default:l(()=>[t(k,{label:"菜单类型",prop:"menuType"},{default:l(()=>[t(C,{modelValue:u(a).menuType,"onUpdate:modelValue":n[1]||(n[1]=f=>u(a).menuType=f)},{default:l(()=>[t(m,{value:"M"},{default:l(()=>[y("目录")]),_:1}),t(m,{value:"C"},{default:l(()=>[y("菜单")]),_:1}),t(m,{value:"F"},{default:l(()=>[y("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(V,{span:24},{default:l(()=>[u(a).menuType!="F"?(N(),x(k,{key:0,label:"菜单图标",prop:"icon"},{default:l(()=>[t(oe,{placement:"bottom",width:"508",trigger:"click"},{reference:l(()=>[t(I,{modelValue:u(a).icon,"onUpdate:modelValue":n[2]||(n[2]=f=>u(a).icon=f),readonly:"",placeholder:"请选择菜单图标",clearable:""},{prefix:l(()=>[u(a).icon?(N(),x(q,{key:0,iconName:u(a).icon,iconType:u(a).iconType},null,8,["iconName","iconType"])):(N(),x(g,{key:1},{default:l(()=>[t(u(he))]),_:1}))]),_:1},8,["modelValue"])]),default:l(()=>[t(ae,{modelValue:u(o),"onUpdate:modelValue":n[3]||(n[3]=f=>ye(o)?o.value=f:null)},{default:l(()=>[t(W,{label:"Svg",name:"Svg"},{default:l(()=>[t(Ie,{onIconActiveSelect:s,iconSelectName:u(a).icon},null,8,["iconSelectName"])]),_:1}),t(W,{label:"element",name:"element"},{default:l(()=>[t(Ue,{onIconActiveSelect:s,iconSelectName:u(a).icon},null,8,["iconSelectName"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0)]),_:1}),t(V,{span:12},{default:l(()=>[t(k,{label:"菜单名称",prop:"menuName"},{default:l(()=>[t(I,{modelValue:u(a).menuName,"onUpdate:modelValue":n[4]||(n[4]=f=>u(a).menuName=f),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(V,{span:12},{default:l(()=>[t(k,{label:"显示排序",prop:"sortNum"},{default:l(()=>[t(ne,{modelValue:u(a).sortNum,"onUpdate:modelValue":n[5]||(n[5]=f=>u(a).sortNum=f),placeholder:"请输入排序","controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),u(a).menuType!="F"?(N(),x(V,{key:0,span:12},{default:l(()=>[t(k,{prop:"isLink"},{label:l(()=>[t(S,{content:"选择是外链则路由地址需要以`http(s)://`开头",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 是否外链 ")]),default:l(()=>[t(C,{modelValue:u(a).isLink,"onUpdate:modelValue":n[6]||(n[6]=f=>u(a).isLink=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("是")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),u(a).menuType!="F"?(N(),x(V,{key:1,span:12},{default:l(()=>[t(k,{prop:"path"},{label:l(()=>[t(S,{content:"访问的路由地址，如：`user`，如外网地址需内链访问则以`http(s)://`开头",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 路由地址 ")]),default:l(()=>[t(I,{modelValue:u(a).path,"onUpdate:modelValue":n[7]||(n[7]=f=>u(a).path=f),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),u(a).menuType=="C"?(N(),x(V,{key:2,span:12},{default:l(()=>[t(k,{prop:"component"},{label:l(()=>[t(S,{content:"访问的组件路径，如：`system/user/index`，默认在`views`目录下",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 组件路径 ")]),default:l(()=>[t(I,{modelValue:u(a).component,"onUpdate:modelValue":n[8]||(n[8]=f=>u(a).component=f),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),u(a).menuType!="M"?(N(),x(V,{key:3,span:12},{default:l(()=>[t(k,{prop:"perms"},{label:l(()=>[t(S,{content:"控制器中定义的权限字符，如：system:user:list",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 权限字符 ")]),default:l(()=>[t(I,{modelValue:u(a).perms,"onUpdate:modelValue":n[9]||(n[9]=f=>u(a).perms=f),placeholder:"请输入权限字符"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),u(a).menuType=="C"?(N(),x(V,{key:4,span:12},{default:l(()=>[t(k,{prop:"isCache"},{label:l(()=>[t(S,{content:"选择是则会被`keep-alive`缓存，需要匹配组件的`name`和地址保持一致",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 是否缓存 ")]),default:l(()=>[t(C,{modelValue:u(a).isCache,"onUpdate:modelValue":n[10]||(n[10]=f=>u(a).isCache=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("缓存")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("不缓存")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),u(a).menuType!="F"?(N(),x(V,{key:5,span:12},{default:l(()=>[t(k,{prop:"visible"},{label:l(()=>[t(S,{content:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 显示状态 ")]),default:l(()=>[t(C,{modelValue:u(a).visible,"onUpdate:modelValue":n[11]||(n[11]=f=>u(a).visible=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("显示")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("隐藏")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),t(V,{span:12},{default:l(()=>[t(k,null,{label:l(()=>[t(S,{content:"选择停用则路由将不会出现在侧边栏，也不能被访问",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 菜单状态 ")]),default:l(()=>[t(C,{modelValue:u(a).status,"onUpdate:modelValue":n[12]||(n[12]=f=>u(a).status=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("正常")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])])}}}),yl=Ne(Ze,[["__scopeId","data-v-f00dbb59"]]);export{yl as default};
