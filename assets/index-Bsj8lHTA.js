import{g as re,r as p,R as ie,a4 as de,o as d,h as N,x as t,y as l,k as e,a5 as ue,a6 as me,a7 as m,a8 as ce,t as u,D as _,a9 as pe,aa as $,ag as _e,ab as fe,v as z,ac as ge,bh as he,J as be,ad as I,ae as V,af as C,bi as we,a1 as ve,N as ye}from"./index-CpodFpUQ.js";import{v as Ve}from"./el-loading-BOfnPg9C.js";import{E as Ce,a as Ee}from"./el-table-column-CD1Eg5LV.js";import"./el-checkbox-gOJjs20a.js";import{E as ke}from"./el-link-1sriVKj4.js";import{E as Fe}from"./el-switch-CHw-uFi2.js";import{E as Ie}from"./el-card-q23y_vI7.js";import{E as xe}from"./el-row-D5xM9lwf.js";import{E as De}from"./el-col-57__bE4T.js";import{a as Se,E as Pe}from"./el-form-item-CvcOi-Xh.js";import{E as Ue}from"./el-date-picker-CRvtB8U1.js";import{E as Ne,a as $e}from"./el-select-B4_7IAkN.js";import{u as ze,g as Te,d as T,a as B,b as Be,c as Le}from"./userForm-BrhMXTg_.js";import{p as Ae,d as Me}from"./index-DgcNhbwt.js";import{_ as Re}from"./pagination.vue_vue_type_script_setup_true_lang-CFSpbPsp.js";import{_ as Oe}from"./importUpload.vue_vue_type_script_setup_true_lang-ComOKFG4.js";import{u as je}from"./dict-BF9NBz1l.js";import"./debounce-DB3PlMcl.js";import"./_baseClone-Bd2QEoHD.js";import"./isEqual-DA5FAILj.js";import"./index-D5u5-p8S.js";import"./token-DI9FKtlJ.js";import"./strings-tw-UTuVM.js";import"./el-dialog-BdRR_6YM.js";import"./el-radio-BM65Nv2y.js";import"./el-progress-GAzN0prh.js";import"./upload-DpPL4qb1.js";import"./data-dQwJxLXj.js";const wa=re({__name:"index",setup(qe){const{sys_show_hide:L}=je("sys_show_hide"),f=p([]),x=p(),E=p(!1),s=p({currentPage:1,pageSize:10}),D=p(0),g=()=>{s.value.currentPage=1,k()},S=()=>{x.value.resetFields(),g()},P=p([]),i=p({dialogVisible:!1,title:"",userForm:{},id:null}),h=p({dialogVisible:!1,title:"",uploadFile:{temlateUrl:"/user/excel/temlate",uploadUrl:"/api/user/import",autoUpload:!1}}),A=()=>{i.value.dialogVisible=!0,i.value.title="新增"},M=()=>{i.value.dialogVisible=!1,i.value.userForm={},i.value.id=null,g()},R=o=>{Te(o).then(n=>{i.value.userForm=n.data,i.value.title="编辑",i.value.dialogVisible=!0})},O=o=>{f.value=o.map(n=>n.userId)},j=o=>{I("是否确认删除？").then(()=>{T(o).then(n=>{V(n.message),g()})})},q=()=>{if(f.value.length==0){C("请选择要删除的数据");return}I("是否确认删除？").then(()=>{T(f.value.toString()).then(o=>{V(o.message),g()})})},J=(o,n)=>{B({userId:o,status:n}).then(r=>{r.status==200?V(r.message):C(r.message),g()})},k=()=>{E.value=!0,Be(s.value).then(o=>{P.value=o.data.list,D.value=o.data.total,E.value=!1})},Q=o=>{s.value.pageSize=o,g()},G=o=>{s.value.currentPage=o,k()},H=()=>{if(f.value.length==0){C("请选择要导出的数据");return}I("是否确认导出？").then(()=>{let o={userIds:f.value.toString()};Le(o).then(n=>{Me(n.data.data,"用户信息")})})},K=()=>{h.value.dialogVisible=!0,h.value.title="导入用户信息"},W=()=>{h.value.dialogVisible=!1,h.value.title="",S()},X=o=>{we("新密码：","修改密码",/^(?!.*[<>\"'\\|])(?=.*[^\s]).{5,20}$/,"用户密码不能为空并且长度必须介于 5 和 20 之间并且不能包含非法字符：(< > ” ' \\ | ","请输入新密码").then(({value:n})=>{B({userId:o,password:n}).then(r=>{r.status==200?V(r.message):C(r.message)})})};return ie(()=>{k()}),(o,n)=>{const y=ve,r=Se,Y=Ne,Z=$e,ee=Ue,w=ye,ae=Pe,te=De,le=xe,U=Ie,c=Ce,oe=Fe,F=ke,ne=Ee,b=de("hasPermi"),se=Ve;return d(),N("div",null,[t(U,null,{default:l(()=>[t(ae,{model:e(s),ref_key:"seachFormRef",ref:x,"label-width":"auto",inline:!0},{default:l(()=>[t(r,{label:"用户名称",prop:"userName"},{default:l(()=>[t(y,{class:"w200",modelValue:e(s).userName,"onUpdate:modelValue":n[0]||(n[0]=a=>e(s).userName=a),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"手机号码",prop:"phoneNumber"},{default:l(()=>[t(y,{class:"w200",modelValue:e(s).phoneNumber,"onUpdate:modelValue":n[1]||(n[1]=a=>e(s).phoneNumber=a),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1}),t(r,{label:"状态",prop:"status"},{default:l(()=>[t(Z,{class:"w200",modelValue:e(s).status,"onUpdate:modelValue":n[2]||(n[2]=a=>e(s).status=a),placeholder:"请选择用户状态",style:{width:"240px"}},{default:l(()=>[(d(!0),N(ue,null,me(e(L),a=>(d(),m(Y,{key:a.dictDataId,label:a.dictDataLabel,value:a.dictDataValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"创建时间",prop:"startAndEndTime"},{default:l(()=>[t(ee,{class:"w200",modelValue:e(s).startAndEndTime,"onUpdate:modelValue":n[3]||(n[3]=a=>e(s).startAndEndTime=a),type:"daterange","range-separator":"—","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1}),t(r,null,{default:l(()=>[t(w,{type:"primary",icon:e(ce),onClick:g},{default:l(()=>[u("搜索")]),_:1},8,["icon"]),t(w,{onClick:S},{default:l(()=>[u("重置")]),_:1})]),_:1})]),_:1},8,["model"]),t(le,{justify:"end"},{default:l(()=>[t(te,{span:24},{default:l(()=>[_((d(),m(w,{type:"primary",plain:"",icon:e(pe),onClick:A},{default:l(()=>[u("新增")]),_:1},8,["icon"])),[[b,["sys_user_add"]]]),_((d(),m(w,{type:"danger",plain:"",icon:e($),disabled:!(e(f).length>0),onClick:q},{default:l(()=>[u("批量删除")]),_:1},8,["icon","disabled"])),[[b,["sys_user_delete"]]]),_((d(),m(w,{icon:e(_e),plain:"",type:"info",onClick:K},{default:l(()=>[u("导入")]),_:1},8,["icon"])),[[b,["sys_user_import"]]]),_((d(),m(w,{icon:e(fe),plain:"",type:"warning",disabled:!(e(f).length>0),onClick:H},{default:l(()=>[u("导出")]),_:1},8,["icon","disabled"])),[[b,["sys_user_export"]]])]),_:1})]),_:1})]),_:1}),t(U,null,{default:l(()=>[_((d(),m(ne,{data:e(P),style:{width:"100%"},border:"","empty-text":"暂无数据",onSelectionChange:O},{default:l(()=>[t(c,{type:"selection",width:"55",selectable:(a,v)=>a.userId!=1},null,8,["selectable"]),t(c,{type:"index",align:"center",width:"80",label:"序号"},{default:l(a=>[u(z(a.$index+1),1)]),_:1}),t(c,{prop:"userName","header-align":"center","show-overflow-tooltip":"","min-width":"120",label:"用户名称"}),t(c,{prop:"nickName","header-align":"center","show-overflow-tooltip":"","min-width":"120",label:"用户昵称"}),t(c,{prop:"phoneNumber","header-align":"center","min-width":"150",label:"手机号码"}),t(c,{prop:"status",align:"center",width:"80",label:"状态"},{default:l(a=>[t(oe,{disabled:a.row.userId==1,modelValue:a.row.status,"onUpdate:modelValue":v=>a.row.status=v,onChange:v=>J(a.row.userId,a.row.status),"active-value":"1","inactive-value":"0",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["disabled","modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(c,{prop:"updateDate",align:"center",width:"180",label:"创建时间"},{default:l(a=>[u(z(e(Ae)(a.row.updateDate)),1)]),_:1}),t(c,{prop:"address","header-align":"center",width:"200",label:"操作",fixed:"right"},{default:l(a=>[_((d(),m(F,{underline:!1,disabled:a.row.userId==1,icon:e(ge),type:"success",onClick:v=>R(a.row.userId)},{default:l(()=>[u("编辑")]),_:2},1032,["disabled","icon","onClick"])),[[b,["sys_user_edit"]]]),_((d(),m(F,{underline:!1,disabled:a.row.userId==1,icon:e($),type:"danger",onClick:v=>j(a.row.userId)},{default:l(()=>[u("删除")]),_:2},1032,["disabled","icon","onClick"])),[[b,["sys_user_delete"]]]),_((d(),m(F,{underline:!1,icon:e(he),type:"primary",onClick:v=>X(a.row.userId)},{default:l(()=>[u("重置密码")]),_:2},1032,["icon","onClick"])),[[b,["sys_user_resetPwd"]]])]),_:1})]),_:1},8,["data"])),[[se,e(E)]]),t(Re,{currentPage:e(s).currentPage,pageSize:e(s).pageSize,total:e(D),onPaginationSizeChange:Q,onPaginationCurrentChange:G},null,8,["currentPage","pageSize","total"])]),_:1}),e(i).dialogVisible?(d(),m(ze,{key:0,dialogVisible:e(i).dialogVisible,userForm:e(i).userForm,title:e(i).title,onEmitAddFormBtn:M},null,8,["dialogVisible","userForm","title"])):be("",!0),t(Oe,{dialogVisible:e(h).dialogVisible,title:e(h).title,uploadFile:e(h).uploadFile,onImportClose:W},null,8,["dialogVisible","title","uploadFile"])])}}});export{wa as default};
