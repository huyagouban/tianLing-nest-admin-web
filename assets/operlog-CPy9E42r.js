import{W as y,g as ne,r as f,R as re,a4 as de,o as u,h as v,x as e,y as t,k as a,a5 as B,a6 as R,a7 as g,a8 as ie,t as i,D as E,aa as $,ab as pe,v as s,am as se,s as ue,J as A,af as ce,ad as L,ae as M,a1 as me,N as _e}from"./index-gd7kCRgy.js";import{v as fe}from"./el-loading-_-mYlB4T.js";import{E as ge}from"./el-dialog-HOZYi4L2.js";import{E as he,a as be}from"./el-table-column-8pU4tqzj.js";import"./el-checkbox-B9dyNmaT.js";import{E as we}from"./el-link-gqXlvqu7.js";import{E as ve}from"./el-card-vlImg1A1.js";import{E as ye}from"./el-row-DY6bVN-5.js";import{E as Ee}from"./el-col-MJgKtEjJ.js";import{a as Ve,E as Ce}from"./el-form-item-B0DA7TzJ.js";import{E as De}from"./el-date-picker-Cn9YfEsp.js";import{E as ke,a as Le}from"./el-select-CnMgXmkL.js";import{p as j,d as Se}from"./index-DgcNhbwt.js";import{_ as Te}from"./pagination.vue_vue_type_script_setup_true_lang-DuyEmMZT.js";import{u as Ie}from"./dict-y4_UKi75.js";import{_ as J}from"./dictData.vue_vue_type_script_setup_true_lang-C-r8qok4.js";import"./debounce-AfzU3xsE.js";import"./_baseClone-DdFIvI3H.js";import"./isEqual-DUkHDidl.js";import"./index-CG8g6kB4.js";import"./token-DI9FKtlJ.js";import"./strings-BZHY2u5A.js";import"./data-GFPIWC91.js";function xe(_){return y({url:"oper-log/list",method:"get",params:_})}function Pe(_){return y({url:`oper-log/delete/${_}`,method:"delete"})}function Ne(){return y({url:"oper-log/clear",method:"delete"})}function Oe(_){return y({url:"oper-log/excel/download",method:"get",params:_})}function Fe(_){return y({url:`oper-log/info/${_}`,method:"get"})}const ze={key:0},Ue={key:1},qe={class:"dialog-footer"},pt=ne({__name:"operlog",setup(_){const{monitor_loginLog_status:S,sys_oper_type:T}=Ie("monitor_loginLog_status","sys_oper_type"),h=f([]),I=f(),V=f(!1),r=f({currentPage:1,pageSize:10}),x=f(0),w=()=>{r.value.currentPage=1,C()},Q=()=>{I.value.resetFields(),w()},P=f([]),o=f({viable:!1,title:"操作日志详情",data:{}}),W=p=>{h.value=p.map(n=>n.operId)},G=()=>{if(h.value.length==0){ce("请选择要删除的数据");return}L("是否确认删除？").then(()=>{Pe(h.value.toString()).then(p=>{M(p.message),w()})})},H=()=>{L("是否确认清空？").then(()=>{Ne().then(p=>{M(p.message),w()})})},C=()=>{V.value=!0,xe(r.value).then(p=>{P.value=p.data.list,x.value=p.data.total,V.value=!1})},K=p=>{r.value.pageSize=p,w()},X=p=>{r.value.currentPage=p,C()},Y=()=>{L("是否确认导出？").then(()=>{let p={operIds:h.value?h.value.toString():""};Oe(p).then(n=>{Se(n.data.data,"操作日志")})})},Z=p=>{Fe(p).then(n=>{o.value.data=n.data,o.value.viable=!0})},N=()=>{o.value.viable=!1,o.value.data={}};return re(()=>{C()}),(p,n)=>{const D=me,d=Ve,O=ke,F=Le,ee=De,b=_e,z=Ce,m=Ee,U=ye,q=ve,c=he,te=we,ae=be,le=ge,k=de("hasPermi"),oe=fe;return u(),v("div",null,[e(q,null,{default:t(()=>[e(z,{model:a(r),ref_key:"seachFormRef",ref:I,"label-width":"auto",inline:!0},{default:t(()=>[e(d,{label:"操作地址",prop:"operIp"},{default:t(()=>[e(D,{class:"w200",modelValue:a(r).operIp,"onUpdate:modelValue":n[0]||(n[0]=l=>a(r).operIp=l),placeholder:"请输入操作地址"},null,8,["modelValue"])]),_:1}),e(d,{label:"系统模块",prop:"title"},{default:t(()=>[e(D,{class:"w200",modelValue:a(r).title,"onUpdate:modelValue":n[1]||(n[1]=l=>a(r).title=l),placeholder:"请输入系统模块"},null,8,["modelValue"])]),_:1}),e(d,{label:"操作人员",prop:"operName"},{default:t(()=>[e(D,{class:"w200",modelValue:a(r).operName,"onUpdate:modelValue":n[2]||(n[2]=l=>a(r).operName=l),placeholder:"请输入操作人员"},null,8,["modelValue"])]),_:1}),e(d,{label:"操作类型",prop:"operType"},{default:t(()=>[e(F,{class:"w200",modelValue:a(r).operType,"onUpdate:modelValue":n[3]||(n[3]=l=>a(r).operType=l),placeholder:"请选择操作类型",style:{width:"240px"}},{default:t(()=>[(u(!0),v(B,null,R(a(T),l=>(u(),g(O,{key:l.dictDataId,label:l.dictDataLabel,value:l.dictDataValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"操作状态",prop:"operStatus"},{default:t(()=>[e(F,{class:"w200",modelValue:a(r).operStatus,"onUpdate:modelValue":n[4]||(n[4]=l=>a(r).operStatus=l),placeholder:"请选择登录状态",style:{width:"240px"}},{default:t(()=>[(u(!0),v(B,null,R(a(S),l=>(u(),g(O,{key:l.dictDataId,label:l.dictDataLabel,value:l.dictDataValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"操作时间",prop:"startAndEndTime"},{default:t(()=>[e(ee,{class:"w200",modelValue:a(r).startAndEndTime,"onUpdate:modelValue":n[5]||(n[5]=l=>a(r).startAndEndTime=l),type:"daterange","range-separator":"—","start-placeholder":"开始时间","end-placeholder":"操作时间"},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(b,{type:"primary",icon:a(ie),onClick:w},{default:t(()=>[i("搜索")]),_:1},8,["icon"]),e(b,{onClick:Q},{default:t(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model"]),e(U,{justify:"end"},{default:t(()=>[e(m,{span:24},{default:t(()=>[E((u(),g(b,{type:"danger",plain:"",icon:a($),disabled:!(a(h).length>0),onClick:G},{default:t(()=>[i("批量删除")]),_:1},8,["icon","disabled"])),[[k,["monitor_loginLog_delete"]]]),E((u(),g(b,{type:"danger",plain:"",icon:a($),onClick:H},{default:t(()=>[i("清空")]),_:1},8,["icon"])),[[k,["monitor_loginLog_clear"]]]),E((u(),g(b,{icon:a(pe),plain:"",type:"warning",onClick:Y},{default:t(()=>[i("导出")]),_:1},8,["icon"])),[[k,["monitor_loginLog_export"]]])]),_:1})]),_:1})]),_:1}),e(q,null,{default:t(()=>[E((u(),g(ae,{data:a(P),style:{width:"100%"},border:"","empty-text":"暂无数据",onSelectionChange:W},{default:t(()=>[e(c,{type:"selection",width:"50"}),e(c,{prop:"operId",align:"center",width:"90",label:"日志编号"}),e(c,{prop:"title","header-align":"center","show-overflow-tooltip":"","min-width":"90",label:"系统模块"}),e(c,{prop:"operType",align:"center","show-overflow-tooltip":"",width:"90",label:"操作类型"},{default:t(l=>[e(J,{dictDataOption:a(T),operType:l.row.operType},null,8,["dictDataOption","operType"])]),_:1}),e(c,{prop:"operName",align:"center","show-overflow-tooltip":"",width:"90",label:"操作人员"}),e(c,{prop:"operIp",align:"center","min-width":"90",label:"操作地址"}),e(c,{prop:"operLocation",align:"center","min-width":"90",label:"操作地点"}),e(c,{prop:"operStatus",align:"center","show-overflow-tooltip":"",width:"90",label:"操作状态"},{default:t(l=>[e(J,{dictDataOption:a(S),operType:l.row.operStatus},null,8,["dictDataOption","operType"])]),_:1}),e(c,{prop:"updateDate",align:"center",width:"180",label:"操作日期"},{default:t(l=>[i(s(a(j)(l.row.updateDate)),1)]),_:1}),e(c,{prop:"costTime",align:"center","show-overflow-tooltip":"",width:"90",label:"消耗时间"}),e(c,{align:"center",width:"120",label:"操作",fixed:"right"},{default:t(l=>[e(te,{underline:!1,icon:a(se),type:"primary",onClick:Be=>Z(l.row.operId)},{default:t(()=>[i("详情")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[oe,a(V)]]),e(Te,{currentPage:a(r).currentPage,pageSize:a(r).pageSize,total:a(x),onPaginationSizeChange:K,onPaginationCurrentChange:X},null,8,["currentPage","pageSize","total"]),e(le,{modelValue:a(o).viable,"onUpdate:modelValue":n[6]||(n[6]=l=>a(o).viable=l),title:a(o).title,width:"800","before-close":N},{footer:t(()=>[ue("div",qe,[e(b,{onClick:N},{default:t(()=>[i("关闭")]),_:1})])]),default:t(()=>[e(z,{ref:"form",model:a(o).data,"label-width":"100px",size:"small"},{default:t(()=>[e(U,null,{default:t(()=>[e(m,{span:12},{default:t(()=>[e(d,{label:"操作模块："},{default:t(()=>[i(s(a(o).data.title),1)]),_:1}),e(d,{label:"登录信息："},{default:t(()=>[i(s(a(o).data.operName)+" / "+s(a(o).data.operIp)+" / "+s(a(o).data.operLocation),1)]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(d,{label:"请求地址："},{default:t(()=>[i(s(a(o).data.requestUrl),1)]),_:1}),e(d,{label:"请求方式："},{default:t(()=>[i(s(a(o).data.requestMethod),1)]),_:1})]),_:1}),e(m,{span:24},{default:t(()=>[e(d,{label:"操作方法："},{default:t(()=>[i(s(a(o).data.operMethod),1)]),_:1})]),_:1}),e(m,{span:24},{default:t(()=>[e(d,{label:"请求参数："},{default:t(()=>[i(s(a(o).data.requestParam),1)]),_:1})]),_:1}),e(m,{span:24},{default:t(()=>[e(d,{label:"返回参数："},{default:t(()=>[i(s(a(o).data.requestResult),1)]),_:1})]),_:1}),e(m,{span:8},{default:t(()=>[e(d,{label:"操作状态："},{default:t(()=>[a(o).data.operStatus==="1"?(u(),v("div",ze,"成功")):a(o).data.operStatus==="0"?(u(),v("div",Ue,"失败")):A("",!0)]),_:1})]),_:1}),e(m,{span:8},{default:t(()=>[e(d,{label:"消耗时间："},{default:t(()=>[i(s(a(o).data.costTime),1)]),_:1})]),_:1}),e(m,{span:8},{default:t(()=>[e(d,{label:"操作时间："},{default:t(()=>[i(s(a(j)(a(o).data.createDate)),1)]),_:1})]),_:1}),e(m,{span:24},{default:t(()=>[a(o).data.operStatus==="0"?(u(),g(d,{key:0,label:"异常信息："},{default:t(()=>[i(s(a(o).data.requestErrmsg),1)]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})])}}});export{pt as default};
