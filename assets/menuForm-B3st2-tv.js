import{u as de,w as P,ar as R,as as B,at as ee,U as w,f as I,g as j,au as ie,av as ce,l as re,aw as me,r as O,ax as H,R as le,ay as D,_ as fe,H as pe,X as _e,o as N,h as ve,x as t,y as l,s as he,t as y,k as s,a7 as x,a8 as ye,S as ke,J as F,ad as be,ae as Y,E as Ve,a1 as Ce,az as ge,N as Ne,Q as Ee}from"./index-gd7kCRgy.js";import{E as xe}from"./el-dialog-HOZYi4L2.js";import{a as Te,E as Ke}from"./el-form-item-B0DA7TzJ.js";import{E as Se}from"./el-row-DY6bVN-5.js";import{E as $,a as Fe,u as Oe,s as Ae,_ as Ie}from"./menu-dAbcQ2Jz.js";import{E as Me}from"./el-input-number-em9BhVNo.js";import{s as Ue,e as we,E as Le}from"./svgSelect-B6Gswk93.js";import{E as Re,a as Be}from"./el-tab-pane-CqlDE6vm.js";import{E as Pe,a as je}from"./el-radio-DNHeE456.js";import{E as qe}from"./el-col-MJgKtEjJ.js";import{a as z,E as Z}from"./el-select-CnMgXmkL.js";import"./el-checkbox-B9dyNmaT.js";import{e as He}from"./strings-BZHY2u5A.js";import{i as De}from"./isEqual-DUkHDidl.js";import{s as $e}from"./token-DI9FKtlJ.js";import"./_baseClone-DdFIvI3H.js";import"./index-CG8g6kB4.js";import"./debounce-AfzU3xsE.js";const ze=(e,{attrs:r,emit:_},{select:v,tree:i,key:d})=>{const a=de("tree-select");return P(()=>e.data,()=>{e.filterable&&R(()=>{var o,V;(V=i.value)==null||V.filter((o=v.value)==null?void 0:o.states.inputValue)})},{flush:"post"}),{...B(ee(e),Object.keys(z.props)),...r,"onUpdate:modelValue":o=>_(w,o),valueKey:d,popperClass:I(()=>{const o=[a.e("popper")];return e.popperClass&&o.push(e.popperClass),o.join(" ")}),filterMethod:(o="")=>{var V;e.filterMethod?e.filterMethod(o):e.remoteMethod?e.remoteMethod(o):(V=i.value)==null||V.filter(o)}}},Qe=j({extends:Z,setup(e,r){const _=Z.setup(e,r);delete _.selectOptionClick;const v=ie().proxy;return R(()=>{_.select.states.cachedOptions.get(v.value)||_.select.onOptionCreate(v)}),P(()=>r.attrs.visible,i=>{_.states.visible=i},{immediate:!0}),_},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function Q(e){return e||e===0}function J(e){return Array.isArray(e)&&e.length}function U(e){return Array.isArray(e)?e:Q(e)?[e]:[]}function L(e,r,_,v,i){for(let d=0;d<e.length;d++){const a=e[d];if(r(a,d,e,i))return v?v(a,d,e,i):a;{const E=_(a);if(J(E)){const o=L(E,r,_,v,a);if(o)return o}}}}function G(e,r,_,v){for(let i=0;i<e.length;i++){const d=e[i];r(d,i,e,v);const a=_(d);J(a)&&G(a,r,_,d)}}const Ge=(e,{attrs:r,slots:_,emit:v},{select:i,tree:d,key:a})=>{P(()=>e.modelValue,()=>{e.showCheckbox&&R(()=>{const u=d.value;u&&!De(u.getCheckedKeys(),U(e.modelValue))&&u.setCheckedKeys(U(e.modelValue))})},{immediate:!0,deep:!0});const E=I(()=>({value:a.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),o=(u,c)=>{var p;const h=E.value[u];return ce(h)?h(c,(p=d.value)==null?void 0:p.getNode(o("value",c))):c[h]},V=U(e.modelValue).map(u=>L(e.data||[],c=>o("value",c)===u,c=>o("children",c),(c,p,h,n)=>n&&o("value",n))).filter(u=>Q(u)),A=I(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const u=[];return G(e.data.concat(e.cacheData),c=>{const p=o("value",c);u.push({value:p,currentLabel:o("label",c),isDisabled:o("disabled",c)})},c=>o("children",c)),u});return{...B(ee(e),Object.keys($.props)),...r,nodeKey:a,expandOnClickNode:I(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:I(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(V):V),renderContent:(u,{node:c,data:p,store:h})=>u(Qe,{value:o("value",p),label:o("label",p),disabled:o("disabled",p),visible:c.visible},e.renderContent?()=>e.renderContent(u,{node:c,data:p,store:h}):_.default?()=>_.default({node:c,data:p,store:h}):void 0),filterNodeMethod:(u,c,p)=>e.filterNodeMethod?e.filterNodeMethod(u,c,p):u?new RegExp(He(u),"i").test(o("label",c)||""):!0,onNodeClick:(u,c,p)=>{var h,n,T,k;if((h=r.onNodeClick)==null||h.call(r,u,c,p),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||c.isLeaf)){if(!o("disabled",u)){const b=(n=i.value)==null?void 0:n.states.options.get(o("value",u));(T=i.value)==null||T.handleOptionSelect(b)}}else e.expandOnClickNode&&p.proxy.handleExpandIconClick();(k=i.value)==null||k.focus()}},onCheck:(u,c)=>{var p;if(!e.showCheckbox)return;const h=o("value",u),n={};G([d.value.store.root],m=>n[m.key]=m,m=>m.childNodes);const T=c.checkedKeys,k=e.multiple?U(e.modelValue).filter(m=>!(m in n)&&!T.includes(m)):[],b=k.concat(T);if(e.checkStrictly)v(w,e.multiple?b:b.includes(h)?h:void 0);else if(e.multiple)v(w,k.concat(d.value.getCheckedKeys(!0)));else{const m=L([u],g=>!J(o("children",g))&&!o("disabled",g),g=>o("children",g)),C=m?o("value",m):void 0,q=Q(e.modelValue)&&!!L([u],g=>o("value",g)===e.modelValue,g=>o("children",g));v(w,C===e.modelValue||q?void 0:C)}R(()=>{var m;const C=U(e.modelValue);d.value.setCheckedKeys(C),(m=r.onCheck)==null||m.call(r,u,{checkedKeys:d.value.getCheckedKeys(),checkedNodes:d.value.getCheckedNodes(),halfCheckedKeys:d.value.getHalfCheckedKeys(),halfCheckedNodes:d.value.getHalfCheckedNodes()})}),(p=i.value)==null||p.focus()},cacheOptions:A}};var Je=j({props:{data:{type:Array,default:()=>[]}},setup(e){const r=re($e);return P(()=>e.data,()=>{var _;e.data.forEach(i=>{r.states.cachedOptions.has(i.value)||r.states.cachedOptions.set(i.value,i)});const v=((_=r.selectRef)==null?void 0:_.querySelectorAll("input"))||[];me&&!Array.from(v).includes(document.activeElement)&&r.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Xe=j({name:"ElTreeSelect",inheritAttrs:!1,props:{...z.props,...$.props,cacheData:{type:Array,default:()=>[]}},setup(e,r){const{slots:_,expose:v}=r,i=O(),d=O(),a=I(()=>e.nodeKey||e.valueKey||"value"),E=ze(e,r,{select:i,tree:d,key:a}),{cacheOptions:o,...V}=Ge(e,r,{select:i,tree:d,key:a}),A=H({});return v(A),le(()=>{Object.assign(A,{...B(d.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...B(i.value,["focus","blur"])})}),()=>D(z,H({...E,ref:u=>i.value=u}),{..._,default:()=>[D(Je,{data:o.value}),D($,H({...V,ref:u=>d.value=u}))]})}});var We=fe(Xe,[["__file","tree-select.vue"]]);const Ye=pe(We),Ze={class:"dialog-footer"},el=j({__name:"menuForm",props:{dialogVisible:{type:Boolean,default:!1},title:{default:""},id:{default:null},menuForm:{default:()=>({})}},emits:["emitAddFormBtn"],setup(e,{emit:r}){const _=r,v=O(),i=O([]),d=e,a=O({parentId:0,menuType:"M",icon:"",iconType:"",menuName:"",sortNum:void 0,isLink:"0",path:"",component:"",perms:"",isCache:"0",visible:"1",status:"1"}),E=O({menuName:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],sortNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"}]}),o=O("Svg"),V=()=>{Fe().then(h=>{const n={id:0,parentId:0,menuName:"主类目",children:[]};n.children=h.data,i.value.push(n)})},A={children:"children",label:"menuName"},u=(h,n)=>{a.value.icon=h,a.value.iconType=n},c=()=>{v.value.validate(h=>{h&&be("是否确认提交？").then(()=>{a.value.id?Oe(a.value).then(n=>{Y("修改成功"),p()}):Ae(a.value).then(n=>{Y("新增成功"),p()})})})},p=()=>{v.value.resetFields(),_("emitAddFormBtn",!1)};return le(()=>{d.menuForm.id&&(a.value=d.menuForm),d.id&&(a.value.parentId=d.id),V()}),(h,n)=>{const T=Ye,k=Te,b=qe,m=Pe,C=je,q=_e("tl-icon"),g=Ve,M=Ce,X=Re,te=Be,ae=Le,oe=Me,K=Ie,S=ge,ne=Se,se=Ke,W=Ne,ue=xe;return N(),ve("div",null,[t(ue,{"model-value":d.dialogVisible,title:d.title,width:"680px","before-close":p,"destroy-on-close":""},{footer:l(()=>[he("div",Ze,[t(W,{type:"primary",onClick:c},{default:l(()=>[y(" 确定 ")]),_:1}),t(W,{onClick:p},{default:l(()=>[y("取消")]),_:1})])]),default:l(()=>[t(se,{model:s(a),ref_key:"formRef",ref:v,"label-width":"100px",rules:s(E)},{default:l(()=>[t(ne,null,{default:l(()=>[t(b,{span:24},{default:l(()=>[t(k,{label:"上级菜单",prop:"parentId"},{default:l(()=>[t(T,{modelValue:s(a).parentId,"onUpdate:modelValue":n[0]||(n[0]=f=>s(a).parentId=f),"node-key":"id","check-strictly":"",placeholder:"请选择上级菜单",props:A,data:s(i),"render-after-expand":!1,style:{width:"508px"}},null,8,["modelValue","data"])]),_:1})]),_:1}),t(b,{span:24},{default:l(()=>[t(k,{label:"菜单类型",prop:"menuType"},{default:l(()=>[t(C,{modelValue:s(a).menuType,"onUpdate:modelValue":n[1]||(n[1]=f=>s(a).menuType=f)},{default:l(()=>[t(m,{value:"M"},{default:l(()=>[y("目录")]),_:1}),t(m,{value:"C"},{default:l(()=>[y("菜单")]),_:1}),t(m,{value:"F"},{default:l(()=>[y("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(b,{span:24},{default:l(()=>[s(a).menuType!="F"?(N(),x(k,{key:0,label:"菜单图标",prop:"icon"},{default:l(()=>[t(ae,{placement:"bottom",width:"508",trigger:"click"},{reference:l(()=>[t(M,{modelValue:s(a).icon,"onUpdate:modelValue":n[2]||(n[2]=f=>s(a).icon=f),readonly:"",placeholder:"请选择菜单图标",clearable:""},{prefix:l(()=>[s(a).icon?(N(),x(q,{key:0,iconName:s(a).icon,iconType:s(a).iconType},null,8,["iconName","iconType"])):(N(),x(g,{key:1},{default:l(()=>[t(s(ye))]),_:1}))]),_:1},8,["modelValue"])]),default:l(()=>[t(te,{modelValue:s(o),"onUpdate:modelValue":n[3]||(n[3]=f=>ke(o)?o.value=f:null)},{default:l(()=>[t(X,{label:"Svg",name:"Svg"},{default:l(()=>[t(Ue,{onIconActiveSelect:u,iconSelectName:s(a).icon},null,8,["iconSelectName"])]),_:1}),t(X,{label:"element",name:"element"},{default:l(()=>[t(we,{onIconActiveSelect:u,iconSelectName:s(a).icon},null,8,["iconSelectName"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0)]),_:1}),t(b,{span:12},{default:l(()=>[t(k,{label:"菜单名称",prop:"menuName"},{default:l(()=>[t(M,{modelValue:s(a).menuName,"onUpdate:modelValue":n[4]||(n[4]=f=>s(a).menuName=f),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(k,{label:"显示排序",prop:"sortNum"},{default:l(()=>[t(oe,{modelValue:s(a).sortNum,"onUpdate:modelValue":n[5]||(n[5]=f=>s(a).sortNum=f),placeholder:"请输入排序","controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),s(a).menuType!="F"?(N(),x(b,{key:0,span:12},{default:l(()=>[t(k,{prop:"isLink"},{label:l(()=>[t(S,{content:"选择是外链则路由地址需要以`http(s)://`开头",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 是否外链 ")]),default:l(()=>[t(C,{modelValue:s(a).isLink,"onUpdate:modelValue":n[6]||(n[6]=f=>s(a).isLink=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("是")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),s(a).menuType!="F"?(N(),x(b,{key:1,span:12},{default:l(()=>[t(k,{prop:"path"},{label:l(()=>[t(S,{content:"访问的路由地址，如：`user`，如外网地址需内链访问则以`http(s)://`开头",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 路由地址 ")]),default:l(()=>[t(M,{modelValue:s(a).path,"onUpdate:modelValue":n[7]||(n[7]=f=>s(a).path=f),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),s(a).menuType=="C"?(N(),x(b,{key:2,span:12},{default:l(()=>[t(k,{prop:"component"},{label:l(()=>[t(S,{content:"访问的组件路径，如：`system/user/index`，默认在`views`目录下",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 组件路径 ")]),default:l(()=>[t(M,{modelValue:s(a).component,"onUpdate:modelValue":n[8]||(n[8]=f=>s(a).component=f),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),s(a).menuType!="M"?(N(),x(b,{key:3,span:12},{default:l(()=>[t(k,{prop:"perms"},{label:l(()=>[t(S,{content:"控制器中定义的权限字符，如：system:user:list",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 权限字符 ")]),default:l(()=>[t(M,{modelValue:s(a).perms,"onUpdate:modelValue":n[9]||(n[9]=f=>s(a).perms=f),placeholder:"请输入权限字符"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),s(a).menuType=="C"?(N(),x(b,{key:4,span:12},{default:l(()=>[t(k,{prop:"isCache"},{label:l(()=>[t(S,{content:"选择是则会被`keep-alive`缓存，需要匹配组件的`name`和地址保持一致",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 是否缓存 ")]),default:l(()=>[t(C,{modelValue:s(a).isCache,"onUpdate:modelValue":n[10]||(n[10]=f=>s(a).isCache=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("缓存")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("不缓存")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),s(a).menuType!="F"?(N(),x(b,{key:5,span:12},{default:l(()=>[t(k,{prop:"visible"},{label:l(()=>[t(S,{content:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 显示状态 ")]),default:l(()=>[t(C,{modelValue:s(a).visible,"onUpdate:modelValue":n[11]||(n[11]=f=>s(a).visible=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("显示")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("隐藏")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),t(b,{span:12},{default:l(()=>[t(k,null,{label:l(()=>[t(S,{content:"选择停用则路由将不会出现在侧边栏，也不能被访问",placement:"top"},{default:l(()=>[t(K,{class:"myicon"})]),_:1}),y(" 菜单状态 ")]),default:l(()=>[t(C,{modelValue:s(a).status,"onUpdate:modelValue":n[12]||(n[12]=f=>s(a).status=f)},{default:l(()=>[t(m,{value:"1"},{default:l(()=>[y("正常")]),_:1}),t(m,{value:"0"},{default:l(()=>[y("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])])}}}),kl=Ee(el,[["__scopeId","data-v-f00dbb59"]]);export{kl as default};
